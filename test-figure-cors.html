<!DOCTYPE html>
<html>
<head>
    <title>Test Figure Markets CORS</title>
</head>
<body>
    <h1>Figure Markets CORS Test</h1>
    <div id="result"></div>
    <script>
        // Test if Figure Markets API allows CORS
        // Test ALL crypto assets from your tracker
        const testAssets = [
            'BTC-USD',      // Bitcoin
            'ETH-USD',      // Ethereum  
            'HASH-USD',     // Figure HASH token
            'FIGR_HELOC-USD', // Figure HELOC token
            'LINK-USD',     // Chainlink
            'SOL-USD',      // Solana
            'UNI-USD',      // Uniswap
            'XRP-USD'       // Ripple
            // Note: FIGR is a stock, not crypto, so won't be in Figure Markets crypto API
        ];
        
        async function testAllAssets() {
            // Test different date ranges for Figure assets - using current dates
            const now = new Date();
            const today = new Date(now);
            const yesterday = new Date(now.getTime() - 24 * 60 * 60 * 1000);
            const lastWeek = new Date(now.getTime() - 7 * 24 * 60 * 60 * 1000);
            const lastMonth = new Date(now.getTime() - 30 * 24 * 60 * 60 * 1000);
            
            const dateRanges = [
                { name: 'Last-24h', start: yesterday.toISOString(), end: today.toISOString() },
                { name: 'Last-7d', start: lastWeek.toISOString(), end: today.toISOString() },
                { name: 'Last-30d', start: lastMonth.toISOString(), end: today.toISOString() },
                { name: 'Aug-2024', start: '2024-08-01T00:00:00.000Z', end: '2024-08-07T00:00:00.000Z' },
                { name: 'Jul-2024', start: '2024-07-01T00:00:00.000Z', end: '2024-07-31T00:00:00.000Z' }
            ];

            for (const asset of testAssets) {
                console.log(`\nüß™ Testing ${asset}...`);
                document.getElementById('result').innerHTML += `<br><strong>${asset}:</strong>`;
                
                // For mainstream cryptos, only test recent date range
                const ranges = (asset === 'BTC-USD' || asset === 'ETH-USD') ? [dateRanges[0]] : dateRanges;
                
                for (const range of ranges) {
                    const testUrl = `https://www.figuremarkets.com/service-hft-exchange/api/v1/markets/${asset}/candles?start_date=${range.start}&end_date=${range.end}&interval_in_minutes=60&size=200`;
                    
                    try {
                        const response = await fetch(testUrl);
                        const data = await response.json();
                        const count = data.matchHistoryData?.length || 0;
                        console.log(`  ${range.name}: ${count} data points`);
                        
                        if (count > 0) {
                            document.getElementById('result').innerHTML += ` ‚úÖ ${range.name}(${count})`;
                        } else {
                            document.getElementById('result').innerHTML += ` ‚ùå ${range.name}(0)`;
                        }
                    } catch (error) {
                        console.log(`  ${range.name}: ${error.message}`);
                        document.getElementById('result').innerHTML += ` ‚ùå ${range.name}(err)`;
                    }
                }
            }
        }
        
        document.getElementById('result').innerHTML = 'Testing Figure Markets historical data availability...<br>';
        testAllAssets();
    </script>
</body>
</html>
